<html>

<head>
    <title>Delta Meet</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/6.2.0/d3.min.js"></script>
    <!-- <script src="https://unpkg.com/aframe-csg-meshs/index.js"></script> -->
    <!-- <script src="https://unpkg.com/aframe-orbit-controls@1.3.0/dist/aframe-orbit-controls.min.js"></script> -->
    <!-- <script src="https://unpkg.com/aframe-supercraft-loader@1.1.3/dist/aframe-supercraft-loader.js"></script> -->
    </a-scene>
    <meta name="apple-mobile-web-app-capable" />

</head>

<body>
    <h1 class="title">Delta Meet</h1>
    <p id="notification" hidden></p>
    <div class="entry-modal" id="entry-modal">
        <p>Create or Join Meeting</p>
        <input value="1" id="room-input" class="room-input" placeholder="Enter Room ID">
        <div>
            <button onclick="createRoom()">Create Room</button>
            <button onclick="joinRoom()">Join Room</button>
        </div>
    </div>
    <div class="meet-area">
        <!-- Remote Video Element-->
        <video id="remote-video" style="display: none;"></video>
        <video id="remote-video-2" style="display: none;"></video>

        <!-- Local Video Element-->
        <video id="local-video" style="display: none;"></video>
        <div class="meet-controls-bar">
            <button onclick="startScreenShare()">Screen Share</button>
        </div>
    </div>
    <p>
        <a-scene inspector="https://cdn.jsdelivr.net/gh/aframevr/aframe-inspector@master/dist/aframe-inspector.min.js">
            <a-entity id="rig" position="0 4 0">

                <a-camera id="cam" look-controls wasd-controls="acceleration:10">
                    <a-cursor color="orange" fuse="true" fuseduration="1500" />

                </a-camera>
            </a-entity>
            <!-- Upper screen -->
            <a-curvedimage position="0 -0.93 2.16" rotation="45.78 0 0" src="#remote-video" height="1.027" radius="5"
                theta-length="25=0" theta-start="165" material="" geometry="thetaLength: 25; thetaStart: 165">
            </a-curvedimage>
            <!-- Middle screen -->
            <a-curvedimage position="0 1.7 3.2" src="#remote-video-2" height="1.027" radius="5" theta-length="25=0"
                theta-start="165"></a-curvedimage>
            <!-- Right screen -->
            <a-curvedimage position="-3.6 1.67 0.89" src="#remote-video-2" height="1.027" radius="5" theta-length="25=0"
                theta-start="140" material="" geometry="thetaLength: 25; thetaStart: 136.76" rotation="0.08 -47.39 0">
            </a-curvedimage>
            <!-- Lower screen -->
            <a-curvedimage position="0 4.69 1.76" rotation="-51.43 0 0" src="#remote-video" height="1.027" radius="5"
                theta-length="25=0" theta-start="165" material="" geometry="thetaLength: 25; thetaStart: 165">
            </a-curvedimage>
            <!-- Left screen -->
            <a-curvedimage position="3.36 1.81 1.43" src="#remote-video-2" height="1.027" radius="5" theta-length="25=0"
                theta-start="190" material="" geometry="thetaLength: 25; thetaStart: 190" rotation="0.08 45 0">
            </a-curvedimage>

            <!-- back screen -->
            <a-curvedimage position="-12.22 1.42 -119.13" src="#remote-video-2" height="1.027" radius="5" theta-length="25=0" theta-start="190" material="height: 268.04" geometry="radius: 5.05; thetaLength: 30.83; thetaStart: 297.34" rotation="-1.76 50.98 0" scale="30.77 28.63 30.18">
            </a-curvedimage>

            <a-plane src="mattblack.jpeg" position="0 0 -4" rotation="-90 0 0" width="4" height="42" color="#7BC8A4">
            </a-plane>
            
            <a-sky src="milky.jpeg"></a-sky>
        </a-scene>
    </p>
</body>

<script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
<script src="script.js"></script>
<script src='https://unpkg.com/panzoom@9.4.0/dist/panzoom.min.js'></script>
<script>

    var rig = document.querySelector("#rig");

    window.addEventListener("wheel", function (event) {
        try {
            console.log(event)

            let x = event.deltaX;
            let y = event.deltaY;

            let currentX = rig.getAttribute("position").x;
            let currentY = rig.getAttribute("position").z;
            console.log(`${x * 0.1} ${y * 0.1} 0`)
            console.log("position", `${x * 0.01 + currentX} ${y * 0.01 + currentY} 0`)
            rig.setAttribute("position", `${x * 0.002 + currentX} 0 ${y * 0.002 + currentY}`)
        }
        catch (e) {
            alert(e);
        }

    });
    // AFRAME.registerComponent('mousecontrol', {
    //     schema: {
    //         min: { type: "number", default: 5 },
    //         max: { type: "number", default: 120 }
    //     },
    //     init: function () {
    //         let self = this;
    //         let sceneEl = document.querySelector("a-scene");
    //         self.camera = sceneEl.querySelector("#cam");
    //         console.log(self)
    //         console.log('min: ', self.data.min);
    //         console.log('max: ', self.data.max);
    //         window.addEventListener("mousewheel", event => {
    //             console.log(event)
    //             let amount = Math.sign(event.deltaY) * 5;
    //             event.deltaY > 0 ? amount = -2 : amount = 2
    //             // amount = -5;
    //             let fov = Number(self.camera.getAttribute('camera').fov);
    //             let adjust = amount + fov;
    //             // alert(fov);
    //             if (adjust < self.data.min) { adjust = self.data.min; }
    //             if (adjust > self.data.max) { adjust = self.data.max; }
    //             self.camera.setAttribute('camera', 'fov', adjust);
    //         });
    //     }
    // });
</script>
<script>


</script>

</html>